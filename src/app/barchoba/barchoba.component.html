<div class="header">
    <span class="home-icon" (click)="homeButtonClicked()">« {{translate('Home')}}</span>
    <span class="header-txt">{{translate('AI Barchoba Game')}}</span>
    <select class="lang-select" (change)="setLanguage($event)">
        <option value="en">EN</option>
        <option value="hu">HU</option>
    </select>
</div>

<div class="form-containers">

    <div class="question-form-container" *ngIf="status === 'question' || status === 'sent' || status === 'answered'">
        <form [formGroup]="questionForm" (ngSubmit)="submitForm()">
            <div class="form-group-row">
                <label for="question" class="form-label">{{translate('Question')}}:</label>
                <input #inputField type="text" id="question" class="form-input" formControlName="questionInput"
                        placeholder="{{translate('Enter your question (4-40 characters)')}}" value="">
                <button type="submit" class="send-button" [disabled]="questionForm.invalid || status !== 'question'">{{translate('Send Question')}}</button>
            </div>
        </form>
        <div class="form-group-row">
            <span class="form-label">{{translate('Answer')}}:</span>
            <span class="form-answer">{{answer}}</span>
            <button class="send-button" (click)="resetForm()" [disabled]="status !== 'answered'">{{translate('Next Question')}}</button>
        </div>
    </div>

    <div class="guess-form-container" *ngIf="status === 'guess' || status === 'guessed' || status === 'completed'">
        <form [formGroup]="guessForm" (ngSubmit)="submitGuess()">
            <div class="form-group-row">
            <label for="guess" class="form-label">{{translate('Guess')}}:</label>
            <input type="text" id="guess" class="form-input" formControlName="guessInput"
                    placeholder="Enter the name" value="">
            <button type="submit" class="send-button" [disabled]="guessForm.invalid || status !== 'guess'">{{translate('Send Guess')}} »</button>
            </div>
        </form>
        <div class="form-group-row">
            <span class="form-label">{{translate('Answer')}}:</span>
            <span class="form-answer">{{answer}}</span>
            <button class="cancel-button" (click)="resetForm()" [disabled]="status !== 'guess'">« {{translate('back to questions')}}</button>
        </div>
    </div>

    <div class="exit-container" *ngIf="status === 'exited'">
        <div class="form-group-row">
            <span class="exit-message">{{exitMsg}}</span>
        </div>
    </div>

    <div class="form-group-row" *ngIf="status === 'answered'">
        <button class="guess-button" (click)="loadGuessForm()" [disabled]="status !== 'answered'">{{translate('Final Guess')}}</button>
        <span class="placeholder"></span>
        <button class="exit-button" (click)="showPopupMsg()" [disabled]="status !== 'answered'">{{translate('I give up')}}</button>
    </div>

    <div class="start-container" *ngIf="status === 'not started' || status === 'starting' || status === 'exited' || status === 'completed'">
        <div class="form-group-row" *ngIf="status === 'not started' || status === 'exited' || status === 'completed'">
            <button class="send-button" (click)="startGame()">{{translate('Start a New Game')}}</button>
        </div>
        <div class="form-group-row" *ngIf="status === 'starting'">
            <h3>{{translate('Loading the Barchoba Game')}}  ...</h3>
        </div>
    </div>    
</div>

<div class="home-image-container" *ngIf="status === 'not started'">
    <img src="../../assets/ovXAM3c.png" alt="" class="home-image">
</div>

<div class="chat-history" #chatHistory *ngIf="status !== 'not started' && status !== 'starting'">
    <div class="msg-gallery" *ngFor="let msg of messages">
        <div class="question" *ngIf="msg.role === 'user'">
            <span class="question-label">
                {{translate('Question')}}:  
            </span>
            <span class="question-content">
                {{msg.content}}
            </span>
        </div>
        <div class="answer" *ngIf="msg.role === 'assistant'">
            <span class="answer-label">
                {{translate('Answer')}}:  
            </span>
            <span class="answer-content">
                {{msg.content}}
            </span>
        </div>
    </div>
</div>

<app-spinner *ngIf="status === 'starting' || status === 'sent' || status === 'guessed'"></app-spinner>

<app-popup *ngIf="showPopup" 
    [popupMessage]="popupMessage" 
    [yesLabel]="translate('Yes')" 
    [noLabel]="translate('No')" 
    (response)="resolvePopup($event)">
</app-popup>


